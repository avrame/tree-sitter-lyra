============
Simple Match
============

// let foo: Maybe<Int> = Some(42)
let bar = match foo {
  Some(42) => "The Answer!",
  Some(_) => "Just some number",
  None => "huh?",
}

---

(program
  (comment)
  (declaration
    (identifier)
    (match_expr
      (identifier)
      (match_arm
        (data_pattern
          (data_type_name)
          (literal_pattern
            (integer)))
        (string_literal
          (string_content)))
      (match_arm
        (data_pattern
          (data_type_name)
          (wildcard_pattern))
        (string_literal
          (string_content)))
      (match_arm
        (data_pattern
          (data_type_name))
        (string_literal
          (string_content))))))

=================
Match with blocks
=================

match foo {
  [a] => {
    // Here is a block
    // With more than one comment
  },
  [a, b] => {
    // Another block
  },
  _ => {
    // The last block
  },
}

---

(program
  (match_expr
    (identifier)
    (match_arm
      (array_pattern
        (identifier))
      (block
        (comment)
        (comment)))
    (match_arm
      (array_pattern
        (identifier)
        (identifier))
      (block
        (comment)))
    (match_arm
      (wildcard_pattern)
      (block
        (comment)))))

===================================
Match with struct literals returned
===================================

let foo = match bar {
  "foo" => { a: "b" },
  "bar" => { b: "a" },
  _ => { c: "d" },
}

---

(program
  (declaration
    (identifier)
    (match_expr
      (identifier)
      (match_arm
        (literal_pattern
          (string_literal
            (string_content)))
        (struct_literal
          (field_name)
          (field_value
            (string_literal
              (string_content)))))
      (match_arm
        (literal_pattern
          (string_literal
            (string_content)))
        (struct_literal
          (field_name)
          (field_value
            (string_literal
              (string_content)))))
      (match_arm
        (wildcard_pattern)
        (struct_literal
          (field_name)
          (field_value
            (string_literal
              (string_content))))))))

=====================
Match with range arms
=====================

 match foo {
  0..=9 => print("one digit"),
  42 => print("The Answer!"),
  10..=99 => print("two digits"),
  _ => print("lots of digits!"),
 }

---

(program
  (match_expr
    (identifier)
    (match_arm
      (range_pattern
        (integer)
        (range_end_operator)
        (integer))
      (postfix_expression
        (identifier)
        (function_call
          (value
            (string_literal
              (string_content))))))
    (match_arm
      (literal_pattern
        (integer))
      (postfix_expression
        (identifier)
        (function_call
          (value
            (string_literal
              (string_content))))))
    (match_arm
      (range_pattern
        (integer)
        (range_end_operator)
        (integer))
      (postfix_expression
        (identifier)
        (function_call
          (value
            (string_literal
              (string_content))))))
    (match_arm
      (wildcard_pattern)
      (postfix_expression
        (identifier)
        (function_call
          (value
            (string_literal
              (string_content))))))))

=================
Match with guards
=================

match foo {
  Some(x) if x > 0 && x < 10 => println("1-9"),
  Some(x) if x >= 10 && x < 100 => println("10-99"),
  None => println("No number!"),
}

---

(program
  (match_expr
    (identifier)
    (match_arm
      (data_pattern
        (data_type_name)
        (identifier))
      (guard
        (boolean_expr
          (boolean_expr
            (identifier)
            (relational_operator
              (greater_than))
            (integer))
          (and)
          (boolean_expr
            (identifier)
            (relational_operator
              (less_than))
            (integer))))
      (postfix_expression
        (identifier)
        (function_call
          (value
            (string_literal
              (string_content))))))
    (match_arm
      (data_pattern
        (data_type_name)
        (identifier))
      (guard
        (boolean_expr
          (boolean_expr
            (identifier)
            (relational_operator
              (greater_than_or_equals))
            (integer))
          (and)
          (boolean_expr
            (identifier)
            (relational_operator
              (less_than))
            (integer))))
      (postfix_expression
        (identifier)
        (function_call
          (value
            (string_literal
              (string_content))))))
    (match_arm
      (data_pattern
        (data_type_name))
      (postfix_expression
        (identifier)
        (function_call
          (value
            (string_literal
              (string_content))))))))

===================================
Match without arms is an error
:error
===================================

match foo {
}

---

(program
  (ERROR
    (identifier)))

===================================
Match arm without body is an error
:error
===================================

match foo {
  Some(x) =>,
  None => "nothing",
}

---

(program
  (match_expr
    (identifier)
    (match_arm
      (data_pattern
        (data_type_name)
        (identifier))
      (ERROR
        (user_defined_type_name))
      (string_literal))))

=====================================
Match arm without pattern is an error
:error
=====================================

match foo {
  => "something"
}

---

(program
  (match_expr
    (identifier)
    (match_arm
      (literal_pattern
        (integer
          (MISSING _digit_sequence)))
      (string_literal))))