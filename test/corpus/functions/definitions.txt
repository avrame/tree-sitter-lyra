=============================================
Basic Function declaration without parameters
=============================================

def foo = () => {
  // do stuff
}

---

(program
  (function_definition
    (function_signature
      (identifier))
        (function_pattern
          (parameter_list)
          (block
            (comment)))))

==============================================================
Basic Function declaration without parameters with return type
==============================================================

def foo: () -> Int =
() => {
  return 42
}

---

(program
  (function_definition
    (function_signature
      (identifier)
      (function_type
        (signed_integer_type)))
        (function_pattern
          (parameter_list)
          (block
            (return_statement
              (integer))))))

==========================================
Basic Function declaration with parameters
==========================================

def sum: (Int, Int) -> Int = (a, b) => a + b

---

(program
  (function_definition
    (function_signature
      (identifier)
      (function_type
        (function_type_parameter_list
          (parameter_type
            (signed_integer_type))
          (parameter_type
            (signed_integer_type)))
        (signed_integer_type)))
        (function_pattern
          (parameter_list
            (parameter
              (identifier))
            (parameter
              (identifier)))
          (addition
            (identifier)
            (identifier)))))

==================================================
Basic Function declaration with generic parameters
==================================================

def sum<n>: (n, n) -> n = (a, b) => a + b

---

(program
  (function_definition
    (function_signature
      (identifier)
      (generic_parameters
        (generic_type))
      (function_type
        (function_type_parameter_list
          (parameter_type
            (generic_type))
          (parameter_type
            (generic_type)))
        (generic_type)))
        (function_pattern
          (parameter_list
            (parameter
              (identifier))
            (parameter
              (identifier)))
          (addition
            (identifier)
            (identifier)))))

==================================
Function declaration with defaults
==================================

def product: (Int, Int) -> Int = (a, b = 10) => a * b

---

(program
  (function_definition
    (function_signature
      (identifier)
      (function_type
        (function_type_parameter_list
          (parameter_type
            (signed_integer_type))
          (parameter_type
            (signed_integer_type)))
        (signed_integer_type)))
      (function_pattern
        (parameter_list
          (parameter
            (identifier))
          (parameter
            (identifier)
            (default_value
              (integer))))
        (multiplication
          (identifier)
          (identifier)))))

=====================================
Function with patterns for parameters
=====================================

def foo: (Str, Int, Point, []Str, SomeTuple) -> void =
(bar, 42, { x, y }, [one, two, three, ...rest], (alpha, beta)) => {
  // do stuff
}

---

(program
  (function_definition
    (function_signature
      (identifier)
      (function_type
        (function_type_parameter_list
          (parameter_type
            (string_type))
          (parameter_type
            (signed_integer_type))
          (parameter_type
            (user_defined_type_name))
          (parameter_type
            (array_type
              (string_type)))
          (parameter_type
            (user_defined_type_name)))
        (generic_type)))
      (function_pattern
        (parameter_list
          (parameter
            (identifier))
          (parameter
            (literal_pattern
              (integer)))
          (parameter
            (struct_pattern
              (identifier)
              (identifier)))
          (parameter
            (array_pattern
              (identifier)
              (identifier)
              (identifier)
              (rest_pattern
                (identifier))))
          (parameter
            (tuple_pattern
              (identifier)
              (identifier))))
        (block
          (comment)))))

=====================
Higher order function
=====================

def map<t,u>: ([]t, (t) -> u) -> []u =
(array, func) => {
  //  new_array = []
  //  for item in array {
  //    new_array.push(func(item))
  //  }
  //  new_array
}

---

(program
  (function_definition
    (function_signature
      (identifier)
      (generic_parameters
        (generic_type)
        (generic_type))
      (function_type
        (function_type_parameter_list
          (parameter_type
            (array_type
              (generic_type)))
          (parameter_type
            (function_type
              (function_type_parameter_list
                (parameter_type
                  (generic_type)))
              (generic_type))))
        (array_type
          (generic_type))))
        (function_pattern
          (parameter_list
            (parameter
              (identifier))
            (parameter
              (identifier)))
          (block
            (comment)
            (comment)
            (comment)
            (comment)
            (comment)))))

========================================
Function with multiple function patterns
========================================

def fib: (Int) -> Int = {
  (0) => 0,
  (1) => 1,
  (n) => fib(n-2) + fib(n-1),
}

---

(program
  (function_definition
    (function_signature
      (identifier)
      (function_type
        (function_type_parameter_list
          (parameter_type
            (signed_integer_type)))
        (signed_integer_type)))
    (function_pattern_list
      (function_pattern
        (parameter_list
          (parameter
            (literal_pattern
              (integer))))
        (integer))
      (function_pattern
        (parameter_list
          (parameter
            (literal_pattern
              (integer))))
        (integer))
      (function_pattern
        (parameter_list
          (parameter
            (identifier)))
        (addition
          (call_expression
            (identifier)
            (argument_list
              (value
                (subtraction
                  (identifier)
                  (integer)))))
          (call_expression
            (identifier)
            (argument_list
              (value
                (subtraction
                  (identifier)
                  (integer))))))))))

==================================================
Function with multiple function patterns and guard
==================================================

def fib: (Int) -> Int = {
  (n) if n < 2 => n,
  (n) => fib(n-2) + fib(n-1),
}

---

(program
  (function_definition
    (function_signature
      (identifier)
      (function_type
        (function_type_parameter_list
          (parameter_type
            (signed_integer_type)))
        (signed_integer_type)))
    (function_pattern_list
      (function_pattern
        (parameter_list
          (parameter
            (identifier)))
        (guard
          (boolean_expr
            (identifier)
            (less_than_operator)
            (integer)))
        (identifier))
      (function_pattern
        (parameter_list
          (parameter
            (identifier)))
        (addition
          (call_expression
            (identifier)
            (argument_list
              (value
                (subtraction
                  (identifier)
                  (integer)))))
          (call_expression
            (identifier)
            (argument_list
              (value
                (subtraction
                  (identifier)
                  (integer))))))))))

===================================
Function without body is an error
:error
===================================

def foo

---

(program
  (ERROR
    (function_signature
      (identifier))))

=============================================
Missing comma in parameters types is an error
:error
=============================================

def foo: (Int Int) -> Int {
  (x, y) => x * y
}

---

(program
  (function_definition
    (function_signature
      (identifier)
      (function_type
        (function_type_parameter_list
          (signed_integer_type))
        (ERROR)
        (signed_integer_type)))
    (function_pattern
      (parameter_list
        (parameter
          (identifier))
        (parameter
          (identifier)))
      (multiplication
        (identifier)
        (identifier)))))

============================================
Missing comma in parameter names is an error
:error
============================================

def foo: (Int, Int) -> Int {
  (x y) => x * y
}

---

(program
  (function_definition
    (function_signature
      (identifier)
      (function_type
        (function_type_parameter_list
          (signed_integer_type)
          (signed_integer_type))
        (signed_integer_type)))
    (function_pattern
      (parameter_list
        (parameter
          (identifier))
        (ERROR
          (UNEXPECTED 'y')))
      (multiplication
        (identifier)
        (identifier)))))